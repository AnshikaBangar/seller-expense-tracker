<!DOCTYPE html>
<html>
  <head>
    <title>Product List</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  </head>
  <body>
    <h1>Product List</h1>
    <form id="form">
      <label for="productName">Product Name:</label>
      <input type="text" id="productName">
      <br>
      <label for="sellingPrice">Selling Price:</label>
      <input type="text" id="sellingPrice">
      <br>
      <button type="submit">Add</button>
    </form>
    <br>
    <h2>Total: <span id="total"></span></h2>
    <ul id="productList">
    </ul>
    <script>
      const form = document.querySelector("#form");
      const productList = document.querySelector("#productList");
      const total = document.querySelector("#total");
  
      form.addEventListener("submit", (e) => {
        e.preventDefault();
        const productName = document.querySelector("#productName").value;
        const sellingPrice = document.querySelector("#sellingPrice").value;
        const product = { productName, sellingPrice };
        axios.post("https://crudcrud.com/api/3068434c26f440beb2cace2f55ab6dd0/products", product).then(() => {
          updateProductList();
          updateTotal();
          form.reset();
        });
      });
  
      const updateProductList = () => {
        axios.get("https://crudcrud.com/api/3068434c26f440beb2cace2f55ab6dd0/products").then((res) => {
          productList.innerHTML = "";
          res.data.forEach((product, i) => {
            const item = document.createElement("li");
            item.innerHTML = `${product.productName} - Rs.${product.sellingPrice}`;
            const deleteBtn = document.createElement("button");
            deleteBtn.innerHTML = "Delete";
            deleteBtn.addEventListener("click", () => {
              axios.delete(`https://crudcrud.com/api/3068434c26f440beb2cace2f55ab6dd0/products/${product._id}`).then(() => {
                updateProductList();
                updateTotal();
              });
            });
            item.appendChild(deleteBtn);
            productList.appendChild(item);
          });
        });
      };
  
      const updateTotal = () => {
        axios.get("https://crudcrud.com/api/3068434c26f440beb2cace2f55ab6dd0/products").then((res) => {
          let sum = 0;
          res.data.forEach((product) => {
            sum += parseInt(product.sellingPrice);
          });
          total.innerHTML = "Rs." + sum;
        });
      };
  
      updateProductList();
      updateTotal();
    </script>
  </body>
</html>
